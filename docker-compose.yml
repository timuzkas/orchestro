services:
  api:
    build:
      context: ./api
      dockerfile: ../Dockerfile.api
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./api/orchestro.db:/app/orchestro.db
    ports:
      - "8080:8080"
    environment:
      - GIN_MODE=release
      - ORCHESTRO_DOMAIN=localhost:8080
      - ORCHESTRO_WEBHOOK_URL=http://localhost:8080/api/v1/webhooks

  web:
    build:
      context: ./web
      dockerfile: ../Dockerfile.web
    ports:
      - "3000:3000"
    environment:
      - NEXT_PUBLIC_API_URL=http://localhost:8080
    depends_on:
      - api
